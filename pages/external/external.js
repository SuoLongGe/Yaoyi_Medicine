Page({
    data: {
      externalRemedies: [
        {
          id: 1,
          name: "药方：瑶医推蛋疗法 颈腰椎方",
          prescription: "行气活血，化瘀止痛",
          brief: "证型：气滞血瘀型",
          syndrome: "气滞血瘀型",
          treatment: "方药：九龙钻15克、鸟不站15克、徐长卿15克、北刘寄奴15克、千年健15克、入山虎15克、血竭10克、杜仲15克。",
          method: "鸡蛋与饮片一同煎煮，开锅后鸡蛋去壳再小火煮15分钟，蛋白与银器布包后行推蛋疗法。",
          restriction: "无",
          attention: "无",
          handle: "无"
        },
        {
          id: 2,
          name: "药方：瑶医风寒感冒方",
          prescription: "疏散表邪",
          brief: "证型：外感风寒",
          syndrome: "外感风寒",
          treatment: "方药：葱头10克、薄荷9克、紫苏叶15克、一枝黄花15克。",
          method: "泡脚",
          restriction: "无",
          attention: "无",
          handle: "无"
        },
        {
          id: 3,
          name: "药方：瑶医带下病方",
          prescription: "清热利湿",
          brief: "证型：湿热",
          syndrome: "湿热",
          treatment: "方药:海金沙8克、车前草8克、白通15克、白芍12克、泽泻6克、白术12克、小藤通15克、青干名木15克、虎杖8克",
          method: "外洗",
          restriction: "无",
          attention: "无",
          handle: "无"
        },
        {
          id: 4,
          name: "药方：瑶医颈椎病外敷方",
          prescription: "通络祛痰",
          brief: "证型：病久生痰，痰瘀留着关节",
          syndrome: "病久生痰，痰瘀留着关节",
          treatment: "方药：独活15克、羌活10克、海风藤10克、千年健10克、牛膝10克、壮骨风10克、桂枝10克、威灵仙10克、芥子10克、土鳖虫10克、地黄20克、骨碎补10克、当归15克、甘草5克。",
          method: "研末外敷患处",
          restriction: "无",
          attention: "无",
          handle: "无"
        },
        {
          id: 5,
          name: "药方：瑶医外洗驱寒止痛汤",
          prescription: "祛风除湿",
          brief: "证型：寒湿型",
          syndrome: "寒湿型",
          treatment: "方药：透骨草20克、艾叶20克、鸡血藤30克、海桐皮15克、制川乌10克、羌活10克、桂枝10克、红花10克、威灵仙30克。",
          method: "外洗",
          restriction: "无",
          attention: "无",
          handle: "无"
        },
        {
          id: 6,
          name: "药方：瑶医外洗止痒方",
          prescription: "清热祛风除湿",
          brief: "证型：湿热型",
          syndrome: "湿热型",
          treatment: "方药：徐长卿30克、荆芥20克、忍冬藤30克、百部20克、牡丹皮30克、连翘20克、苦参30克、地肤子15克、蛇床子15克。",
          method: "外洗",
          restriction: "无",
          attention: "无",
          handle: "无"
        },
        {
          id: 7,
          name: "药方：瑶医黑虎贴",
          prescription: "祛风、散寒",
          brief: "证型：风寒湿痹",
          syndrome: "风寒湿痹",
          treatment: "方药：土鳖虫10克、乳香10克、没药10克、川芎12克、冰片10克、威灵仙12克、独活15克、牛膝10克、姜黄15克、伸筋草10克。",
          method: "外敷患处4-6小时",
          restriction: "无",
          attention: "无",
          handle: "无"
        },
        {
          id: 8,
          name: "药方：瑶医皮肤病方（四）",
          prescription: "清热利湿",
          brief: "证型：湿热",
          syndrome: "湿热",
          treatment: "方药：羊尾巴30克、九里光30克、苍术30克、石菖蒲30克、樟枝叶50克、黑芝麻40克、艾叶20克",
          method: "熬水，外洗20-30分钟",
          restriction: "无",
          attention: "无",
          handle: "无"
        },
        {
          id: 9,
          name: "药方：瑶医治疗疮疡脓肿方",
          prescription: "解毒化脓",
          brief: "证型：热毒",
          syndrome: "热毒",
          treatment: "方药：木芙蓉50克、路边菊40克、藤三七30克。",
          method: "外洗",
          restriction: "无",
          attention: "无",
          handle: "无"
        },
        {
          id: 10,
          name: "药方：瑶医腰椎病外洗方",
          prescription: "祛风湿、活血祛瘀、止痛",
          brief: "证型：风湿痹阻、肝肾亏虚",
          syndrome: "风湿痹阻、肝肾亏虚",
          treatment: "方药：黑老虎15克、伸筋草15克、半边风15克、狗脊（犬片）20克、小茴香20克、牛膝15克、川芎15克、威灵仙15克、甘草10克、杜仲15克、桂枝10克。",
          method: "水煎外洗，一日两次",
          restriction: "无",
          attention: "无",
          handle: "无"
        },
        {
          id: 11,
          name: "药方：瑶医风湿方",
          prescription: "祛风散寒、补益肝肾、通络",
          brief: "证型：风湿湿痹、肝肾亏虚",
          syndrome: "风湿湿痹、肝肾亏虚",
          treatment: "方药:防风15克、麻黄15克、苍术15克、半边风35克、桂枝15克、桑寄生20克、千年健25克。",
          method: "水煎外洗",
          restriction: "无",
          attention: "无",
          handle: "无"
        },
        {
          id: 12,
          name: "药方：瑶医瑶山活络油",
          prescription: "活血散瘀止痛",
          brief: "证型：瘀血阻滞",
          syndrome: "瘀血阻滞",
          treatment: "方药：牛膝20克、青风藤20克、半边风15克、钻骨风20克、伸筋草30克、川芎15克、虎杖10克、鳖甲10克、红花10克、制草乌10克、全蝎6克、蜈蚣5克。",
          method: "上药做成药茶，外用，每天2-3次擦患处。",
          restriction: "无",
          attention: "无",
          handle: "无"
        },
        {
          id: 13,
          name: "药方：瑶医腰腿痛熏洗方",
          prescription: "活血化瘀，温经通络",
          brief: "证型：瘀血阻滞",
          syndrome: "瘀血阻滞",
          treatment: "方药：牛膝20克、钻骨风10克、小藤通10克、桂枝10克、苍术10克、木芙蓉10克、伸筋草10克、泽兰10克",
          method: "水煎熏洗患处。",
          restriction: "无",
          attention: "无",
          handle: "无"
        },
        {
          id: 14,
          name: "药方：瑶医中风足浴方",
          prescription: "益气活血化瘀",
          brief: "证型：气滞血瘀证",
          syndrome: "气滞血瘀证",
          treatment: "方药：梅花血藤15克、黄芪30克、当归	10克、独活10克、鸡血藤30克、半边风	15克、苍术10克、小藤通	10克、鸡爪风	10克、大红钻10克",
          method: "水煎足浴，1日2次。",
          restriction: "无",
          attention: "无",
          handle: "无"
        },
        {
          id: 15,
          name: "药方：瑶医偏瘫药浴方",
          prescription: "益气活血，化瘀通络",
          brief: "证型：气虚血瘀证",
          syndrome: "气虚血瘀证",
          treatment: "方药：壮骨风	15克、鸡血藤30克、络石藤	15克、黄芪30克、木瓜30克、羌活20克、独活20克、桂枝15克、桑枝10克、半边风10克、红九牛10克",
          method: "水煎熏洗治疗，1天2次。",
          restriction: "无",
          attention: "无",
          handle: "无"
        },
        {
          id: 16,
          name: "药方：瑶医颈痛方",
          prescription: "活血止痛",
          brief: "证型：血瘀证",
          syndrome: "血瘀证",
          treatment: "方药：钻骨风15克、入山虎20克、鸡爪风10克、一刺两嘴15克、八角风15克",
          method: "打粉外敷，3-5日为一疗程。",
          restriction: "无",
          attention: "无",
          handle: "无"
        },
        {
          id: 17,
          name: "药方：瑶医关节痛药浴方",
          prescription: "祛风清热，祛湿通络",
          brief: "证型：湿热阻滞证",
          syndrome: "湿热阻滞证",
          treatment: "方药：海风藤50克、梅花血藤50克、羌活30克、毛老虎30克、千年健20克、透骨草30克、松树根20克",
          method: "水煎4000ml，药浴。",
          restriction: "无",
          attention: "无",
          handle: "无"
        },
        {
          id: 18,
          name: "药方：瑶医骨痛足浴方",
          prescription: "散寒湿，通经络",
          brief: "证型：寒湿瘀血阻滞",
          syndrome: "寒湿瘀血阻滞",
          treatment: "方药：黑钻20克、紫九牛15克、大松筋15克、大接骨风15克、海风藤15克、钻骨风10克、木瓜15克",
          method: "水煎泡脚。",
          restriction: "无",
          attention: "无",
          handle: "无"
        },
        {
          id: 19,
          name: "药方：瑶医咳嗽贴敷方",
          prescription: "祛痰、止咳、平喘",
          brief: "证型：风痰壅肺证",
          syndrome: "风痰壅肺证",
          treatment: "方药：紫苏子10克、莱菔子10克、鱼腥草15克、益母草10克、芥子9克",
          method: "打粉调制外敷。",
          restriction: "无",
          attention: "无",
          handle: "无"
        },
        {
          id: 20,
          name: "药方：瑶医止痒外洗方",
          prescription: "清热祛湿止痒",
          brief: "证型：湿热蕴肤证",
          syndrome: "湿热蕴肤证",
          treatment: "方药：九里光20克、野菊花20克、黄花倒水莲15克、荆芥10克、地肤子15克、白鲜皮15克",
          method: "煎水外洗。",
          restriction: "无",
          attention: "无",
          handle: "无"
        }
      ],
      matchedList: [],
      unmatchedList: [],
    },
  
    onSearchBlur(e) {
      const searchValue = e.detail.value.trim().toLowerCase(); // 获取搜索内容并转为小写
  
      // 如果搜索内容为空，认为是未匹配项，直接放入 unmatchedList
      if (searchValue === '') {
        this.setData({
          matchedList: [], // 没有匹配项
          unmatchedList: this.data.externalRemedies // 所有项都视为不匹配项
        });
        return;
      }
  
      // 根据搜索内容进行分类
      const matched = this.data.externalRemedies.filter(remedy => 
        remedy.name.toLowerCase().includes(searchValue)  // 匹配的项
      );
      const unmatched = this.data.externalRemedies.filter(remedy => 
        !remedy.name.toLowerCase().includes(searchValue) // 未匹配的项
      );
  
      // 组合：先显示匹配的，再显示未匹配的
      this.setData({
        matchedList: matched,
        unmatchedList: unmatched,
      });
    },
  
    goToDetail(event) {
      const id = event.currentTarget.dataset.id;
      const remedy = this.data.externalRemedies.find(item => item.id === id);
  
      wx.navigateTo({
        url: `/pages/external_detail/external_detail?id=${remedy.id}&name=${encodeURIComponent(remedy.name)}&brief=${encodeURIComponent(remedy.brief)}&syndrome=${encodeURIComponent(remedy.syndrome)}&treatment=${encodeURIComponent(remedy.prescription)}&prescription=${encodeURIComponent(remedy.treatment)}&method=${encodeURIComponent(remedy.method)}`
      });
    },
  
    // 点击底部导航栏的处理函数
    onTabClick: function (e) {
      const page = e.currentTarget.dataset.page;  // 获取点击的页面名称
      switch (page) {
        case 'index':
          wx.navigateTo({
            url: '/pages/index/index'
          });
          break;
        case 'user':
          wx.navigateTo({
            url: '/pages/user/user'
          });
          break;
        case 'news':
          wx.navigateTo({
            url: '/pages/news/news'
          });
          break;
        case 'search':
          wx.navigateTo({
            url: '/pages/search/search'
          });
          break;
        default:
          break;
      }
    },
  
    onLoad(options) {
      this.setData({
        matchedList: [],
        unmatchedList: this.data.externalRemedies
      });
    },
  
    goBack() {
      wx.navigateBack();
    },
  
    onReady() {},
    onShow() {},
    onHide() {},
    onUnload() {},
    onPullDownRefresh() {},
    onReachBottom() {},
    onShareAppMessage() {}
  });
  